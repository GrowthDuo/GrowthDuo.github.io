<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="x5-fullscreen" content="true">
<meta name="full-screen" content="yes">
<meta name="theme-color" content="#317EFB" />
<meta content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=0" name="viewport">
<meta name="description" content="Selenium简介Selenium 是支持 web 浏览器自动化的一系列工具和库的综合项目。 通过它，我们可以写出自动化程序，像人一样在浏览器里操作web界面。 比如点击界面按钮，在文本框中输入文字 等操作。 Selenium 的核心是 WebDriver，这是一个编写指令集的接口，可以在许多浏览器中互换运行。 这里有一个最简单的说明： 123456789101112# 导入sele">
<meta property="og:type" content="website">
<meta property="og:title" content="Selenium">
<meta property="og:url" content="http://example.com/selenium/index.html">
<meta property="og:site_name" content="duoduo">
<meta property="og:description" content="Selenium简介Selenium 是支持 web 浏览器自动化的一系列工具和库的综合项目。 通过它，我们可以写出自动化程序，像人一样在浏览器里操作web界面。 比如点击界面按钮，在文本框中输入文字 等操作。 Selenium 的核心是 WebDriver，这是一个编写指令集的接口，可以在许多浏览器中互换运行。 这里有一个最简单的说明： 123456789101112# 导入sele">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-11-21T08:45:05.000Z">
<meta property="article:modified_time" content="2023-12-24T08:18:43.940Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">


<title >Selenium</title>

<!-- Favicon -->

    <link href='/log.svg?v=2.1.8' rel='icon' type='image/png' sizes='16x16' ></link>


    <link href='/log.svg?v=2.1.8' rel='icon' type='image/png' sizes='32x32' ></link>


    <link href='/log.svg?v=2.1.8' rel='apple-touch-icon' sizes='180x180' ></link>


    <link href='/site.webmanifest' rel='manifest' ></link>


<!-- Plugin -->




    
<link rel="stylesheet" href="/css/plugins/bootstrap.row.css">

    
<link rel="stylesheet" href="https://npm.elemecdn.com/@fancyapps/ui@4.0/dist/fancybox.css">

    
    




<!-- Icon -->

    
<link rel="stylesheet" href="/css/plugins/font-awesome.min.css">




<!-- Variable -->
<script>window.ASYNC_CONFIG = {"hostname":"example.com","author":"John Doe","root":"/","typed_text":["   Welcome to Doduo Blog!！"],"theme_version":"2.1.8","theme":{"switch":true,"default":"style-light"},"favicon":{"logo":"log.svg","icon16":"log.svg","icon32":"log.svg","appleTouchIcon":"log.svg","webmanifest":"/site.webmanifest","visibilitychange":true,"hidden":"failure.ico","showText":"(/≧▽≦/)咦！又好了！","hideText":"(●—●)喔哟，崩溃啦！"},"i18n":{"placeholder":"搜索文章...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）","author":"本文作者：","copyright_link":"本文链接：","copyright_license_title":"版权声明：","copyright_license_content":"本博客所有文章除特别声明外，均默认采用 undefined 许可协议。","copy_success":"复制成功","copy_failure":"复制失败","open_read_mode":"进入阅读模式","exit_read_mode":"退出阅读模式","notice_outdate_message":"距离上次更新已经 undefined 天了, 文章内容可能已经过时。","sticky":"置顶","just":"刚刚","min":"分钟前","hour":"小时前","day":"天前","month":"个月前"},"swup":false,"plugin":{"flickr_justified_gallery":"https://npm.elemecdn.com/flickr-justified-gallery@latest/dist/fjGallery.min.js"},"icons":{"sun":"far fa-sun","moon":"far fa-moon","play":"fas fa-play","email":"far fa-envelope","next":"fas fa-arrow-right","calendar":"far fa-calendar-alt","clock":"far fa-clock","user":"far fa-user","back_top":"fas fa-arrow-up","close":"fas fa-times","search":"fas fa-search","reward":"fas fa-hand-holding-usd","user_tag":"fas fa-user-alt","toc_tag":"fas fa-th-list","read":"fas fa-book-reader","arrows":"fas fa-arrows-alt-h","double_arrows":"fas fa-angle-double-down","copy":"fas fa-copy"},"icontype":"font","highlight":{"plugin":"highlighjs","theme":true,"copy":true,"lang":false,"title":"mac","height_limit":200},"toc":{"post_title":false},"covers":["https://tse2-mm.cn.bing.net/th/id/OIP-C.oXAnSYbzVsbSefXPrBrnXwHaEo?w=299&h=185&c=7&r=0&o=5&dpr=1.3&pid=1.7","https://tse2-mm.cn.bing.net/th/id/OIP-C.rYoa1aoGGOEFAOmSZ2rMxwHaEK?w=306&h=180&c=7&r=0&o=5&dpr=1.3&pid=1.7","https://tse1-mm.cn.bing.net/th/id/OIP-C.ywbRATlid7MvbT9RMV3_PAHaEo?w=316&h=197&c=7&r=0&o=5&dpr=1.3&pid=1.7","https://th.bing.com/th/id/OIP.SjKW64OE3fkRJQHjZKLs7AHaEo?w=300&h=187&c=7&r=0&o=5&dpr=1.5&pid=1.7","https://th.bing.com/th/id/OIP.rGEQ4KKeoEPNnU7ofmvm3QHaEo?w=292&h=182&c=7&r=0&o=5&dpr=1.5&pid=1.7","https://th.bing.com/th/id/OIP.Tq6zaOLRndcM73hqCL23tgHaEo?w=262&h=180&c=7&r=0&o=5&dpr=1.5&pid=1.7","https://th.bing.com/th/id/OIP.fbmVvqcTmK2ByjtyUx03WgHaEo?w=288&h=180&c=7&r=0&o=5&dpr=1.5&pid=1.7","https://th.bing.com/th/id/OIP.Wu0wS4p3cLe2UxQWyLqXlQHaEo?w=291&h=182&c=7&r=0&o=5&dpr=1.5&pid=1.7","https://th.bing.com/th/id/OIP.F537cYYpIFdjNTuMHmpSWQHaEK?w=333&h=187&c=7&r=0&o=5&dpr=1.5&pid=1.7"]};</script>
<script id="async-page-config">window.PAGE_CONFIG = {"isPost":false,"isHome":false,"postUpdate":"2023-12-24 16:18:43"};</script>

<!-- Theme mode css -->
<link data-swup-theme rel="stylesheet" href="/css/index.css?v=2.1.8" id="trm-switch-style">
<script>
    let defaultMode = ASYNC_CONFIG.theme.default !=='auto' ?  ASYNC_CONFIG.theme.default : (window.matchMedia("(prefers-color-scheme: light)").matches ? 'style-light' : 'style-dark')
    let catchMode = localStorage.getItem('theme-mode') || defaultMode;
    let type = catchMode === 'style-dark' ? 'add' : 'remove';
    document.documentElement.classList[type]('dark')
</script>

<!-- CDN -->


    
    



<!-- Site Analytics -->
 
<meta name="generator" content="Hexo 6.3.0"></head>

<body>

  <!-- app wrapper -->
  <div class="trm-app-frame">

    <!-- page preloader -->
    <div class="trm-preloader">
    <div class="trm-holder">
        <div class="preloader">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</div>
    <!-- page preloader end -->

    <!-- change mode preloader -->
    <div class="trm-mode-swich-animation-frame">
    <div class="trm-mode-swich-animation">
        <i class="i-sun"><i class="iconfont far fa-sun"></i></i>
        <div class="trm-horizon"></div>
        <i class="i-moon"><i class="iconfont far fa-moon"></i></i>
    </div>
</div>
    <!-- change mode preloader end -->

      <!-- scroll container -->
      <div id="trm-dynamic-content" class="trm-swup-animation">
        <div id="trm-scroll-container" class="trm-scroll-container" style="opacity: 0">
            <!-- top bar -->
            <header class="trm-top-bar">
	<div class="container">
		<div class="trm-left-side">
			<!-- logo -->
<a href="/" class="trm-logo-frame trm-anima-link">
    
        <img alt="logo" src="/log.svg">
    
    
        <div class="trm-logo-text">
            成长<span>之路 ！</span>
        </div>
    
</a>
<!-- logo end -->
		</div>
		<div class="trm-right-side">
			<!-- menu -->
<div class="trm-menu">
    <nav>
        <ul>
            
            <li class="menu-item-has-children ">
                <a  href="/" target="">
                    首页
                </a>
                
                <ul>
                    
                    <li>
                        <a  href="/Git1/" target="">
                            git
                        </a>
                    </li>
                    
                    <li>
                        <a  href="/archives2/" target="">
                            go
                        </a>
                    </li>
                    
                    <li>
                        <a  href="/archives3/" target="">
                            python
                        </a>
                    </li>
                    
                    <li>
                        <a  href="/db4/" target="">
                            mysql
                        </a>
                    </li>
                    
                    <li>
                        <a  href="/db5/" target="">
                            redis
                        </a>
                    </li>
                    
                    <li>
                        <a  href="/Liunx5/" target="">
                            Liunx
                        </a>
                    </li>
                    
                    <li>
                        <a  href="/selenium/" target="">
                            Selenium
                        </a>
                    </li>
                    
                    <li>
                        <a  href="/qita6/" target="">
                            其他
                        </a>
                    </li>
                    
                </ul>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/archives/" target="">
                    文章
                </a>
                
                <ul>
                    
                    <li>
                        <a data-no-swup href="/archives/" target="">
                            归档
                        </a>
                    </li>
                    
                    <li>
                        <a data-no-swup href="/categories/" target="">
                            分类
                        </a>
                    </li>
                    
                    <li>
                        <a data-no-swup href="/tags/" target="">
                            标签
                        </a>
                    </li>
                    
                </ul>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a data-no-swup href="/BUG/" target="">
                    Bug
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/" target="">
                    框架
                </a>
                
                <ul>
                    
                    <li>
                        <a data-no-swup href="/frameWork/" target="">
                            Flask
                        </a>
                    </li>
                    
                    <li>
                        <a data-no-swup href="/" target="">
                            pytest
                        </a>
                    </li>
                    
                    <li>
                        <a data-no-swup href="/" target="">
                            其他
                        </a>
                    </li>
                    
                </ul>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/" target="">
                    百宝箱
                </a>
                
                <ul>
                    
                    <li>
                        <a data-no-swup href="/test/" target="">
                            相册
                        </a>
                    </li>
                    
                    <li>
                        <a data-no-swup href="/danCi/" target="">
                            单词
                        </a>
                    </li>
                    
                </ul>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/" target="">
                    休闲
                </a>
                
                <ul>
                    
                    <li>
                        <a  href="/music/" target="">
                            音盒
                        </a>
                    </li>
                    
                    <li>
                        <a  href="/movie/" target="">
                            影院
                        </a>
                    </li>
                    
                    <li>
                        <a  href="/bangumis/" target="">
                            追番
                        </a>
                    </li>
                    
                </ul>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/" target="">
                    社交
                </a>
                
                <ul>
                    
                    <li>
                        <a  href="/friend/" target="">
                            朋友圈
                        </a>
                    </li>
                    
                    <li>
                        <a  href="/leave/" target="">
                            留言板
                        </a>
                    </li>
                    
                    <li>
                        <a  href="/links/" target="">
                            友人链
                        </a>
                    </li>
                    
                </ul>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/" target="">
                    个人
                </a>
                
                <ul>
                    
                    <li>
                        <a data-no-swup href="/about/" target="">
                            关于
                        </a>
                    </li>
                    
                </ul>
                
            </li>
            
        </ul>
    </nav>
</div>
<!-- menu end -->
			
    <!-- mode switcher place -->
    <div class="trm-mode-switcher-place">
        <div class="trm-mode-switcher">
            <i class="iconfont far fa-sun"></i>
            <input class="tgl tgl-light" id="trm-swich" type="checkbox">
            <label class="trm-swich" for="trm-swich"></label>
            <i class="iconfont far fa-moon"></i>
        </div>
    </div>
    <!-- mode switcher place end -->

			
		</div>
		<div class="trm-menu-btn">
			<span></span>
		</div>
	</div>
</header>
            <!-- top bar end -->

            <!-- body -->
            

    
<div class="trm-content-start">
    <!-- banner -->
    <div class="trm-banner">
    
    <!-- banner cover -->
    <img style="object-position:top;object-fit:cover;" alt="banner" class="trm-banner-cover" src="/img/banner.png">
    <!-- banner cover end -->
    

    <!-- banner content -->
    <div class="trm-banner-content trm-overlay">
        <div class="container">
            <div class="row">
                
                <div class="col-lg-4"></div>
                
                <div class="col-lg-8">

                    <!-- banner title -->
                    <div class="trm-banner-text ">
                        <div class="trm-label trm-mb-20">
                            Hi my new friend!
                        </div>
                        <h1 class="trm-mb-30 trm-hsmb-font">
                            Selenium
                        </h1>

                        
                            <ul class="trm-breadcrumbs trm-label">
                                <li>
                                    <a href="/" class="trm-anima-link">Home</a>
                                </li>
                                <li>
                                    <span>
                                        selenium
                                    </span>
                                </li>
                            </ul>
                        
                    </div>
                    <!-- banner title end -->

                    <!-- scroll hint -->
                    <span id="scroll-triger" class="trm-scroll-hint-frame">
                        <div class="trm-scroll-hint"></div>
                        <span class="trm-label">Scroll down</span>
                    </span>
                    <!-- scroll hint end -->

                </div>
            </div>
        </div>
    </div>
    <!-- banner content end -->
</div>
    <!-- banner end -->
    <div class="container">
        <div class="row">
            
                <div class="trm-page-sidebar col-lg-4 hidden-sm">
                    <!-- main card -->
                    <div class="trm-main-card-frame trm-sidebar">
    <div class="trm-main-card"> 
        <!-- card header -->
<div class="trm-mc-header">
    <div class="trm-avatar-frame trm-mb-20">
        <img alt="Avatar" class="trm-avatar" src="/img/avatar.jpg">
    </div>
    <h5 class="trm-name trm-mb-15">
        多多
    </h5>
    
        <div class="trm-label">
            欢迎来到多多博客！
            <span class="trm-typed-text">
                <!-- Words for theme.user.typedText -->
            </span>
        </div>
    
</div>
<!-- card header end -->
        <!-- sidebar social -->

<div class="trm-divider trm-mb-40 trm-mt-40"></div>
<div class="trm-social">
    
        <a href="https://github.com/GrowthDuo/GrowthDuo.github.io" title="github" rel="nofollow" target="_blank">
            <i class="iconfont fab fa-github"></i>
        </a>
    
        <a href="https://gitee.com" title="gitee" rel="nofollow" target="_blank">
            <i class="iconfont fab fa-gofore"></i>
        </a>
    
        <a href="https://space.bilibili.com/503585184?spm_id_from=333.1007.0.0" title="B站" rel="nofollow" target="_blank">
            <i class="iconfont fab fa-bitcoin"></i>
        </a>
    
</div>

<!-- sidebar social end -->
        <!-- info -->
<div class="trm-divider trm-mb-40 trm-mt-40"></div>
<ul class="trm-table trm-mb-20">
    
        <li>
            <div class="trm-label">
                地址:
            </div>
            <div class="trm-label trm-label-light">
                Mars
            </div>
        </li>
    
</ul>
<!-- info end -->

        
    <div class="trm-divider trm-mb-40 trm-mt-40"></div>
    <!-- action button -->
    <div class="text-center">
        <a href="mailto:2016583339@qq.com" class="trm-btn">
            联系我
            <i class="iconfont far fa-envelope"></i>
        </a>
    </div>
    <!-- action button end -->

    </div>
</div>
                    <!-- main card end -->
                </div>
            
            <div class="trm-page-content col-lg-8">
                <div id="trm-content" class="trm-content">
                    <br />

<br />

<br />

<h4 id="Selenium简介"><a href="#Selenium简介" class="headerlink" title="Selenium简介"></a>Selenium简介</h4><p>Selenium 是支持 web 浏览器自动化的一系列工具和库的综合项目。</p>
<p>通过它，我们可以写出自动化程序，像人一样在浏览器里操作web界面。 比如点击界面按钮，在文本框中输入文字 等操作。</p>
<p>Selenium 的核心是 <a target="_blank" rel="noopener" href="https://www.selenium.dev/zh-cn/documentation/webdriver/">WebDriver</a>，这是一个编写指令集的接口，可以在许多浏览器中互换运行。 这里有一个最简单的说明：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入selenium库的webdriver模块</span></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"> <span class="comment"># 创建一个Chrome浏览器的WebDriver对象</span></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line"> <span class="comment"># 打开百度首页</span></span><br><span class="line">driver.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 退出关闭页面</span></span><br><span class="line">driver.quit()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br />

<br />

<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>Selenium环境的安装主要就是安装两样东西： <code>客户端库</code> 和 <code>浏览器 驱动</code> 。</p>
<br />

<ol>
<li><p>安装客户端</p>
<ol>
<li>python安装使用pip命令，打开 “命令行程序”</li>
</ol>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install selenium</span><br></pre></td></tr></table></figure>

<p>​			<br /></p>
<pre><code>        2. 如果安装不了，可能是网络问题，可以指定使用国内的豆瓣源
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install selenium -i https://pypi.douban.com/simple/</span><br></pre></td></tr></table></figure>

<p>​		<br /></p>
<ol start="3">
<li>如果想要安装自己想要的版本</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install selenium==版本号</span><br></pre></td></tr></table></figure>

<p>​		<br /></p>
</li>
</ol>
<h4 id="安装Chrome浏览器"><a href="#安装Chrome浏览器" class="headerlink" title="安装Chrome浏览器"></a>安装Chrome浏览器</h4><p>这里我们选用的是谷歌浏览器，当然如果你想使用其他浏览器也可以，只需要下载其他浏览器的驱动即可。</p>
<p>谷歌浏览器下载地址 【<a target="_blank" rel="noopener" href="https://www.google.cn/chrome/">Google Chrome 网络浏览器</a>】</p>
<p>​	<br /></p>
<p>​		<br /></p>
<h4 id="安装Chrome浏览器驱动"><a href="#安装Chrome浏览器驱动" class="headerlink" title="安装Chrome浏览器驱动"></a>安装Chrome浏览器驱动</h4><p>浏览器安装好以后，接下来就是安装浏览器驱动 Chrome Driver。</p>
<p> 在 Chrome 115 版本以后， <code>Chrome Driver</code> 下载网站变了，现在访问地址为 【<a target="_blank" rel="noopener" href="https://googlechromelabs.github.io/chrome-for-testing/">Chrome for Testing availability (googlechromelabs.github.io)</a>，选择当前的版本的浏览器对应的驱动，然后进行环境配置Path。</p>
<p>​		<br /></p>
<p>​		<br /></p>
<h4 id="选择元素的基本方法"><a href="#选择元素的基本方法" class="headerlink" title="选择元素的基本方法"></a>选择元素的基本方法</h4><h5 id="八大定位"><a href="#八大定位" class="headerlink" title="八大定位"></a>八大定位</h5><p>•By.id(id)：通过ID 属性查找</p>
<p>•By.name(name)：通过name属性查找</p>
<p>•By.className(className) ：通过classname属性查找</p>
<p>•By.linkText(链接文本)：通过链接文本</p>
<p>•By.partialLinkText(部分链接文本)：通过部分链接文本</p>
<p>•By.cssSelector(Css路径)：通过CSS路径</p>
<p>•By.tagName(name)：通过tagname查找</p>
<p>•By.xpath(XPath路径)：通过XPath查找</p>
<p>​		<br /></p>
<p>​		<br /></p>
<h5 id="根据-id属性-选择元素"><a href="#根据-id属性-选择元素" class="headerlink" title="根据 id属性 选择元素"></a>根据 id属性 选择元素</h5><h6 id="selenium4-的语法"><a href="#selenium4-的语法" class="headerlink" title="selenium4 的语法"></a>selenium4 的语法</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line">element = wd.find_element(By.ID, <span class="string">&quot;kw&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用这个对象的 send_keys 方法就可以在对应的元素中 输入字符串，</span></span><br><span class="line"><span class="comment"># 方法1、 加上\n 就是搜索</span></span><br><span class="line">element.send_keys(<span class="string">&quot;pyhton\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法2</span></span><br><span class="line"><span class="comment"># find_element = wd.find_element(By.ID, &quot;go&quot;)</span></span><br><span class="line"><span class="comment"># 点击搜索按钮</span></span><br><span class="line"><span class="comment"># find_element.click()</span></span><br><span class="line"></span><br><span class="line">wd.quit()</span><br></pre></td></tr></table></figure>

<p>​		<br /></p>
<p>​		<br /></p>
<h5 id="根据class的定位"><a href="#根据class的定位" class="headerlink" title="根据class的定位"></a>根据class的定位</h5><h6 id="定位多个"><a href="#定位多个" class="headerlink" title="# 定位多个"></a># 定位多个</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 WebDriver 实例对象，指明使用chrome浏览器驱动</span></span><br><span class="line">wc = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line"><span class="comment"># WebDriver 实例对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line">wc.get(<span class="string">&quot;https://cdn2.byhy.net/files/selenium/sample1.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># class属性是多个一样的，定位多个，4.0的写法 ：</span></span><br><span class="line"><span class="comment"># 注意element后面多了个s</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据 class name 选择元素，返回的是 一个列表</span></span><br><span class="line"><span class="comment"># 里面 都是class 属性值为 animal的元素对应的 WebElement对象</span></span><br><span class="line">element = wc.find_elements(By.CLASS_NAME, <span class="string">&quot;plant&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取出列表中的每个 WebElement对象，打印出其text属性的值</span></span><br><span class="line"><span class="comment"># text属性就是该 WebElement对象对应的元素在网页中的文本内容</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> element:</span><br><span class="line">    <span class="built_in">print</span>(i.text)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">wc.quit()</span><br></pre></td></tr></table></figure>

<p>​	<br /></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># class属性是多个一样的，定位多个 4.0下的写法</span></span><br><span class="line"><span class="comment"># wc.find_elements_by_class_name(&#x27;plant&#x27;)</span></span><br></pre></td></tr></table></figure>

<p>​	<br /></p>
<h6 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">注意</span></span><br><span class="line"><span class="string">find_elements 与 find_element区别</span></span><br><span class="line"><span class="string">判断是否有元素可以用find_elements</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">根据 class name 选择元素，返回的是 一个列表</span></span><br><span class="line"><span class="string">find_elements 返回的是找到的符合条件的 所有 元素 (这里有3个元素)， 放在一个 列表 中返回。</span></span><br><span class="line"><span class="string">    如果没有找到，则返回一个空列表</span></span><br><span class="line"><span class="string">而如果我们使用 wd.find_element (注意少了一个s) 方法， 就只会返回 第一个 元素。</span></span><br><span class="line"><span class="string">    如果没有找到，则抛出异常</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>​	<br /></p>
<p>​	<br /></p>
<h4 id="等待"><a href="#等待" class="headerlink" title="等待"></a>等待</h4><p>有时候我们进行自动化时，操作过快，导致页面还未加载完毕就开始了定位操作，这时我们是找不到元素了就会因此也报错。</p>
<p>​	<br /></p>
<ul>
<li>隐式等待 ，或者 全局等待</li>
<li>找不到元素， 每隔 半秒钟 再去界面上查看一次， 直到找到该元素， 或者 过了10秒 最大时长</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome.implicitly_wait(<span class="number">10</span>) <span class="comment"># 任意位置都可以</span></span><br></pre></td></tr></table></figure>

<p>​	<br /></p>
<ul>
<li>或者使用sleep, 更简易使用上一种。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">chrome = webdriver.Chrome()</span><br><span class="line">chrome.get(<span class="string">&#x27;https://www.byhy.net/_files/stock1.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">element = chrome.find_element(By.ID, <span class="string">&#x27;kw&#x27;</span>)</span><br><span class="line">element.send_keys(<span class="string">&quot;股份\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用sleep 未知等待多长时间</span></span><br><span class="line"><span class="comment"># sleep(1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 隐式等待 ，或者 全局等待</span></span><br><span class="line"><span class="comment"># 不到元素， 每隔 半秒钟 再去界面上查看一次， 直到找到该元素， 或者 过了10秒 最大时长</span></span><br><span class="line">chrome.implicitly_wait(<span class="number">10</span>) <span class="comment"># 任意位置都可以</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回页面 ID为1 的元素</span></span><br><span class="line">element2 = chrome.find_element(By.ID, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment"># 打印该元素的文字内容</span></span><br><span class="line"><span class="built_in">print</span>(element2.text)</span><br></pre></td></tr></table></figure>



<h5 id="WebElement-对象-选择元素"><a href="#WebElement-对象-选择元素" class="headerlink" title="WebElement 对象 选择元素"></a><em>WebElement</em> <em>对象 选择元素</em></h5><h6 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h6><ul>
<li>不仅WebDriver对象有 选择元素 的方法， *WebElement对象 也有选择元素的方法。</li>
<li>WebElement对象 也可以调用 find_elements，find_element之类的方法</li>
<li>WebDriver <em>对象 选择元素的范围是 整个</em> web页面， 而WebElement对象 选择元素的范围是 该元素的内部。</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 WebDriver 实例对象，指明使用chrome浏览器驱动</span></span><br><span class="line">chrome = webdriver.Chrome()</span><br><span class="line">chrome.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># WebDriver 对象</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># WebElement 对象 选择元素的范围是 该元素的内部。</span></span><br><span class="line"><span class="comment"># 一对标签里包含许多子标签  相当于子标签的标头</span></span><br><span class="line">element = chrome.find_element(By.ID, <span class="string">&#x27;container&#x27;</span>) <span class="comment"># 此处_element未加s      相当于子标签的标头</span></span><br><span class="line"><span class="comment"># 相当于从父标签里查找</span></span><br><span class="line"><span class="comment"># # 限制 选择元素的范围是 id 为 container 元素的内部。</span></span><br><span class="line">spans = element.find_elements(By.TAG_NAME, <span class="string">&#x27;span&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> spans:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;WebElement 对象 : &#x27;</span>,i.text)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="comment"># WebDriver 对象 选择元素的范围是 整个 web页面</span></span><br><span class="line">S_web = chrome.find_elements(By.TAG_NAME, <span class="string">&#x27;span&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> S_web:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;WebDriver 对象 :&#x27;</span>, s.text)</span><br></pre></td></tr></table></figure>

<p>​	<br /></p>
<p>​	<br /></p>
<h4 id="操控元素的基本方法"><a href="#操控元素的基本方法" class="headerlink" title="操控元素的基本方法"></a>操控元素的基本方法</h4><p>操控元素通常包括</p>
<ul>
<li><p>点击元素</p>
</li>
<li><p>在元素中输入字符串，通常是对输入框这样的元素</p>
</li>
<li><p>输入框中已经有的内容清除掉, 可以使用 <strong>WebElement</strong>对象的 <strong>clear</strong> 方法</p>
</li>
<li><p>获取元素包含的信息，比如文本内容，元素的属性</p>
<p>​	<br /></p>
</li>
</ul>
<h5 id="点击元素"><a href="#点击元素" class="headerlink" title="点击元素"></a>点击元素</h5><p><code>点击元素</code> 非常简单，就是调用元素WebElement对象的 click方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line">find_element = wd.find_element(By.ID, <span class="string">&quot;go&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 点击搜索按钮</span></span><br><span class="line">find_element.click()</span><br><span class="line"></span><br><span class="line">wd.quit()</span><br></pre></td></tr></table></figure>

<h5 id=""><a href="#" class="headerlink" title=""></a><br /></h5><h5 id="输入框"><a href="#输入框" class="headerlink" title="输入框"></a>输入框</h5><p><code>输入字符串</code> 也非常简单，就是调用元素WebElement对象的send_keys方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line"></span><br><span class="line">element = wd.find_element(By.ID, <span class="string">&quot;kw&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用这个对象的 send_keys 方法就可以在对应的元素中 输入字符串，</span></span><br><span class="line"><span class="comment"># 方法1、 加上\n 就是搜索</span></span><br><span class="line">element.send_keys(<span class="string">&quot;pyhton\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>​	<br /></p>
<h5 id="获取元素的文本内容"><a href="#获取元素的文本内容" class="headerlink" title="获取元素的文本内容"></a>获取元素的文本内容</h5><p><em>通过<strong>WebElement</strong>对象的</em> <em>text</em> <em>属性，可以获取元素 展示在界面上的 文本内容。</em></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先进行定位</span></span><br><span class="line">element = wd.find_element(By.ID, <span class="string">&#x27;animal&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(element.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​	<br /></p>
<h5 id="获取元素属性"><a href="#获取元素属性" class="headerlink" title="获取元素属性"></a><em>获取元素属性</em></h5><p><em>通过<strong>WebElement</strong>对象的</em> <em>get_attribute</em> <em>方法来获取元素的属性值<br>比如要获取元素属性<strong>class</strong>的值，就可以使用</em> <em>element.get_attribute(‘class’)</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> element = wd.find_element(By.ID, <span class="string">&#x27;input_name&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(element.get_attribute(<span class="string">&#x27;class&#x27;</span>))</span><br></pre></td></tr></table></figure>



<h5 id="获取整个区域盒子的内容"><a href="#获取整个区域盒子的内容" class="headerlink" title="获取整个区域盒子的内容"></a>获取整个区域盒子的内容</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(element.get_attribute(<span class="string">&#x27;outerHTML&#x27;</span>))</span><br></pre></td></tr></table></figure>



<h5 id="获取区域盒子内部的内容"><a href="#获取区域盒子内部的内容" class="headerlink" title="获取区域盒子内部的内容"></a>获取区域盒子内部的内容</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(element.get_attribute(<span class="string">&#x27;innerHTML&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>​	<br />	<br /></p>
<h4 id="切换到新的窗口"><a href="#切换到新的窗口" class="headerlink" title="切换到新的窗口"></a><em>切换到新的窗口</em></h4><ul>
<li><p>在网页上操作的时候，我们经常遇到，点击一个链接 或者 按钮，就会打开一个 新窗口 。</p>
</li>
<li><p><strong>访问</strong>bing<strong>网站</strong>， 就会弹出一个新窗口。</p>
</li>
<li><p>如果我们要到新的窗口里面操作，该怎么做呢？<br><em>可以使用 <strong>Webdriver</strong> 对象的<strong>switch_to</strong>属性的</em> window<strong>方法，如下所示：</strong></p>
</li>
<li><p>wd.switch_to.window(handle)</p>
</li>
<li><p>其中，参数<strong>handle</strong>需要传入什么呢？</p>
</li>
<li><p><em>WebDriver<strong>对象有</strong>window_handles</em> 属性，这是一个列表对象， 里面包括了当前浏览器里面所有的窗口句柄。</p>
</li>
<li><p>所谓句柄，大家可以想象成对应网页窗口的一个<strong>ID</strong></p>
</li>
</ul>
<h5 id="获取所有窗口句柄"><a href="#获取所有窗口句柄" class="headerlink" title="获取所有窗口句柄"></a>获取所有窗口句柄</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">handles = wd.window_handles</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(handles)</span><br></pre></td></tr></table></figure>

<p>​	<br /></p>
<h5 id="切换窗口句柄"><a href="#切换窗口句柄" class="headerlink" title="切换窗口句柄"></a><em>切换窗口句柄</em></h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.switch_to.window(handles[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<p>​	<br /></p>
<h6 id="例如"><a href="#例如" class="headerlink" title="例如"></a>例如</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.implicitly_wait(<span class="number">10</span>)</span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample3.html&#x27;</span>)</span><br><span class="line">element = wd.find_element(By.TAG_NAME, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">element.click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行切换窗体</span></span><br><span class="line"><span class="comment"># 获取当前窗口句柄，方便切回来</span></span><br><span class="line">handle = wd.current_window_handle</span><br><span class="line"><span class="comment"># 获取所有窗口句柄</span></span><br><span class="line">handles = wd.window_handles</span><br><span class="line"><span class="built_in">print</span>(handles)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换窗口句柄</span></span><br><span class="line">wd.switch_to.window(handles[<span class="number">1</span>])</span><br><span class="line"><span class="comment"># wd.title属性是当前窗口的标题栏 文本</span></span><br><span class="line"><span class="built_in">print</span>(wd.title)</span><br><span class="line"><span class="comment"># 在新窗口里进行操作</span></span><br><span class="line">find_element = wd.find_element(By.ID, <span class="string">&quot;sb_form_q&quot;</span>)</span><br><span class="line"></span><br><span class="line">find_element.send_keys(<span class="string">&quot;python\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line"><span class="comment"># 返回之前的窗体</span></span><br><span class="line">wd.switch_to.window(handle)</span><br><span class="line"><span class="built_in">print</span>(wd.title)</span><br></pre></td></tr></table></figure>

<p>​	<br />	<br /></p>
<h4 id="frame-切换"><a href="#frame-切换" class="headerlink" title="frame 切换"></a>frame 切换</h4><p>如果您需要使用框架或 iframe, WebDriver 允许您以相同的方式使用它们。考虑 iframe 中的一个按钮。 如果我们使用浏览器开发工具检查元素，我们可能会看到以下内容:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;modal&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">&quot;buttonframe&quot;</span><span class="attr">name</span>=<span class="string">&quot;myframe&quot;</span><span class="attr">src</span>=<span class="string">&quot;https://seleniumhq.github.io&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">button</span>&gt;</span>Click here<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​	<br /></p>
<p>如果不是 iframe，我们可能会使用如下方式点击按钮:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 这不会工作</span></span><br><span class="line">driver.find_element(By.TAG_NAME, <span class="string">&#x27;button&#x27;</span>).click()</span><br></pre></td></tr></table></figure>

<p>​	<br /></p>
<p>但是，如果 iframe 之外没有按钮，那么您可能会得到一个 <em>no such element 无此元素</em> 的错误。 这是因为 Selenium 只知道顶层文档中的元素。为了与按钮进行交互，我们需要首先切换到框架， 这与切换窗口的方式类似。WebDriver 提供了三种切换到帧的方法。</p>
<br />

<h5 id="使用-WebElement"><a href="#使用-WebElement" class="headerlink" title="使用 WebElement"></a>使用 WebElement</h5><p>使用 WebElement 进行切换是最灵活的选择。您可以使用首选的选择器找到框架并切换到它。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 存储网页元素</span></span><br><span class="line">iframe = driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;#modal &gt; iframe&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 切换到选择的 iframe</span></span><br><span class="line">driver.switch_to.frame(iframe)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 单击按钮</span></span><br><span class="line">driver.find_element(By.TAG_NAME, <span class="string">&#x27;button&#x27;</span>).click()</span><br></pre></td></tr></table></figure>

<br />

<h5 id="使用-name-或-id"><a href="#使用-name-或-id" class="headerlink" title="使用 name 或 id"></a>使用 name 或 id</h5><p>如果您的 frame 或 iframe 具有 id 或 name 属性，则可以使用该属性。如果名称或 id 在页面上不是唯一的， 那么将切换到找到的第一个。</p>
<br />

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 通过 id 切换框架</span></span><br><span class="line">driver.switch_to.frame(<span class="string">&#x27;buttonframe&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 单击按钮</span></span><br><span class="line">driver.find_element(By.TAG_NAME, <span class="string">&#x27;button&#x27;</span>).click()</span><br></pre></td></tr></table></figure>

<br />

<h5 id="使用索引"><a href="#使用索引" class="headerlink" title="使用索引"></a>使用索引</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 基于索引切换到第 2 个 iframe</span></span><br><span class="line">iframe = driver.find_elements(By.TAG_NAME,<span class="string">&#x27;iframe&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 切换到选择的 iframe</span></span><br><span class="line">driver.switch_to.frame(iframe)</span><br></pre></td></tr></table></figure>

<br />

<h5 id="离开框架"><a href="#离开框架" class="headerlink" title="离开框架"></a>离开框架</h5><p>离开 iframe 或 frameset，切换回默认内容，如下所示:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment"># 切回到默认内容</span></span><br><span class="line">driver.switch_to.default_content()</span><br></pre></td></tr></table></figure>

<p><br /><br /><br /></p>
<h4 id="选择框"><a href="#选择框" class="headerlink" title="选择框"></a>选择框</h4><h5 id="radio-框选择选项"><a href="#radio-框选择选项" class="headerlink" title="radio 框选择选项"></a>radio 框选择选项</h5><ul>
<li>radio<strong>框选择选项 相当于单选框，直接选就可以</strong></li>
<li><strong>radio</strong>框选择选项，直接用<strong>WebElement</strong>的<strong>click</strong>方法，模拟用户点击就可以了。</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">wd.implicitly_wait(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/test2.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取当前谁选中的</span></span><br><span class="line">element = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;[checked = &quot;checked&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;当前选中的是: &#x27;</span> + element.get_attribute(<span class="string">&#x27;value&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行切换</span></span><br><span class="line"><span class="comment"># 点选 小雷老师</span></span><br><span class="line">wd.find_element(By.CSS_SELECTOR,</span><br><span class="line">  <span class="string">&#x27;#s_radio input[value=&quot;小雷老师&quot;]&#x27;</span>).click()</span><br></pre></td></tr></table></figure>

<p>​	<br /></p>
<h5 id="checkbox-多选框"><a href="#checkbox-多选框" class="headerlink" title="checkbox : 多选框"></a><em>checkbox :</em> <em>多选框</em></h5><ul>
<li>对<strong>checkbox</strong>进行选择，也是直接用 <em>WebElement</em> <em>的</em> <em>click</em> 方法，模拟用户点击选择。</li>
<li><strong>需要注意的是，要选中</strong>checkbox的一个选项，必须 先获取当前该复选框的状态 ，如果该选项已经勾选了，就不能再点击。否则反而会取消选择。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">wd.implicitly_wait(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/test2.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取当前谁选中的</span></span><br><span class="line">element = wd.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;#s_checkbox [checked = &quot;checked&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> element:</span><br><span class="line">    name1 = name.get_attribute(<span class="string">&#x27;value&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(name1)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对当前选中的，进行取消</span></span><br><span class="line">    name.click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 全选</span></span><br><span class="line"><span class="comment"># 全选复选框</span></span><br><span class="line">checkboxes = wd.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;#s_checkbox input[type=&quot;checkbox&quot;]&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> checkbox <span class="keyword">in</span> checkboxes:</span><br><span class="line">    <span class="comment"># 使用is_selected()方法检查复选框是否已经被选中</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> checkbox.is_selected():</span><br><span class="line">        checkbox.click()</span><br></pre></td></tr></table></figure>

<p>​	<br /></p>
<h5 id="select-框"><a href="#select-框" class="headerlink" title="select 框"></a>select 框</h5><br />

<h4 id="弹出对话框"><a href="#弹出对话框" class="headerlink" title="弹出对话框"></a>弹出对话框</h4><p><em>弹出的对话框有三种类型，分别是</em> <em>Alert<strong>（警告信息）、</strong>confirm*<em>（确认信息）和</em></em>  prompt（提示输入）*</p>
<br />

<h5 id="Alert"><a href="#Alert" class="headerlink" title="Alert"></a>Alert</h5><p><strong>Alert <em>弹出框，目的就是显示通知信息，只需用户看完信息后，点击</em> OK</strong>（确定） 就可以了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.alert <span class="keyword">import</span> Alert</span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">driver.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/test4.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># --- alert ---</span></span><br><span class="line">driver.find_element(By.ID, <span class="string">&#x27;b1&#x27;</span>).click()</span><br><span class="line"><span class="comment"># 获取弹出窗口</span></span><br><span class="line">alert = Alert(driver)</span><br><span class="line"><span class="comment"># 获取打印窗口文本信息</span></span><br><span class="line"><span class="built_in">print</span>(alert.text)</span><br><span class="line"><span class="comment"># 确认</span></span><br><span class="line">alert.accept()</span><br></pre></td></tr></table></figure>







<h5 id="Confirm"><a href="#Confirm" class="headerlink" title="Confirm"></a>Confirm</h5><ul>
<li><strong>Confirm</strong>弹出框，主要是让用户确认是否要进行某个操作。</li>
<li><strong>比如：当管理员在网站上选择删除某个账号时，就可能会弹出Confirm</strong>弹出框， 要求确认是否确定要删除。</li>
<li><strong>Confirm</strong>弹出框 有两个选择供用户选择，分别是* <em>OK</em> <em>和</em> *Cancel**， 分别代表 确定 和 取消 操作。</li>
<li>那么，自动化的时候，代码怎么模拟用户点击* <em>OK</em> <em>或者</em> <em>Cancel</em> *按钮呢？</li>
<li>如果我们想点击 OK <em>按钮， 还是用刚才的</em> accept方法，如下</li>
<li>如果我们想点击 <em>Cancel</em> <em>按钮， 可以用</em>  dismiss<strong>方法，如下</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.alert <span class="keyword">import</span> Alert</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">driver.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/test4.html&#x27;</span>)</span><br><span class="line">driver.find_element(By.ID, <span class="string">&#x27;b2&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实例化Alert</span></span><br><span class="line">alert = Alert(driver)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 获取文本内容</span></span><br><span class="line"><span class="built_in">print</span>(alert.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试确认按钮</span></span><br><span class="line"><span class="comment"># alert.accept()</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 尝试取消按钮</span></span><br><span class="line">alert.dismiss()</span><br></pre></td></tr></table></figure>

<br />

<h5 id="Prompt"><a href="#Prompt" class="headerlink" title="Prompt"></a>Prompt</h5><ul>
<li><p>出现 <em>Prompt</em> 弹出框 是需要用户输入一些信息，提交上去。</p>
</li>
<li><p>比如：当管理员在网站上选择给某个账号延期时，就可能会弹出 <em>Prompt</em> <em>弹出框， 要求输入延期多长时间。</em></p>
</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.alert <span class="keyword">import</span> Alert</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">driver.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/test4.html&#x27;</span>)</span><br><span class="line"><span class="comment"># --- prompt ---</span></span><br><span class="line">driver.find_element(By.ID, <span class="string">&#x27;b3&#x27;</span>).click()</span><br><span class="line">alert = Alert(driver)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 打印 弹出框 提示信息</span></span><br><span class="line"><span class="built_in">print</span>(alert.text)</span><br><span class="line">sleep(<span class="number">5</span>)</span><br><span class="line"><span class="comment"># 输入信息，并且点击 OK 按钮 提交</span></span><br><span class="line">alert.send_keys(<span class="string">&#x27;你好&#x27;</span>)</span><br><span class="line">alert.accept()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<br />

<br />

<h4 id="鼠标"><a href="#鼠标" class="headerlink" title="鼠标"></a>鼠标</h4><ul>
<li>比如 鼠标右键点击、双击、移动鼠标到某个元素、鼠标拖拽等。</li>
<li>这些操作，可以通过 <em>Selenium</em> <em>提供的</em> <em>ActionChains</em> 类来实现。</li>
<li>ActionChains <em>类 里面提供了 一些特殊的动作的模拟，我们可以通过</em> <em>ActionChains</em> <em>类的代码查看到，如下所示</em></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com/&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.action_chains <span class="keyword">import</span> ActionChains</span><br><span class="line"></span><br><span class="line">ac = ActionChains(driver)\</span><br><span class="line"><span class="comment"># 鼠标移动到 元素上</span></span><br><span class="line">ac.move_to_element(</span><br><span class="line">    driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;[name=&quot;tj_briicon&quot;]&#x27;</span>)</span><br><span class="line">).perform()</span><br></pre></td></tr></table></figure>

<br />

<br />



<h4 id="获取标题"><a href="#获取标题" class="headerlink" title="获取标题"></a>获取标题</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.title</span><br></pre></td></tr></table></figure>

<br />

<h3 id="获取当前-URL"><a href="#获取当前-URL" class="headerlink" title="获取当前 URL"></a>获取当前 URL</h3><p>您可以从浏览器的地址栏读取当前的 URL</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.current_url</span><br></pre></td></tr></table></figure>

<br />

<h4 id="窗口大小"><a href="#窗口大小" class="headerlink" title="窗口大小"></a>窗口大小</h4><p>有时间我们需要获取窗口的属性和相应的信息，并对窗口进行控制</p>
<ul>
<li>获取窗口大小</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.get_window_size()</span><br></pre></td></tr></table></figure>

<ul>
<li>改变窗口大小</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.set_window_size(x, y)</span><br></pre></td></tr></table></figure>

<br />

<h4 id="添加-Cookie"><a href="#添加-Cookie" class="headerlink" title="添加 Cookie"></a>添加 Cookie</h4><p>这个方法常常用于将cookie添加到当前访问的上下文中. 添加Cookie仅接受一组已定义的可序列化JSON对象. <a target="_blank" rel="noopener" href="https://www.w3.org/TR/webdriver1/#cookies">这里</a> 是一个链接, 用于描述可接受的JSON键值的列表</p>
<p>首先, 您需要位于有效Cookie的域上. 如果您在开始与网站进行交互之前尝试预设cookie, 并且您的首页很大或需要一段时间才能加载完毕, 则可以选择在网站上找到一个较小的页面 (通常404页很小, 例如 <a href="http://example.com/some404page">http://example.com/some404page</a>)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.example.com&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Adds the cookie into current browser context</span></span><br><span class="line">driver.add_cookie(&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>: <span class="string">&quot;value&quot;</span>&#125;)</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<br />

<br />

<h4 id="截屏"><a href="#截屏" class="headerlink" title="截屏"></a>截屏</h4><p>执行 <strong>UI自动化</strong> 操作时，大多数时间都是不在现场的，出现错误时，没有办法第一时间查看到，这时我们可以通过截图当时出错的场景保存下来，后面进行查看报错的原因</p>
<h5 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a><strong>方法一</strong></h5><p>get_screenshot_as_base64()整个函数，获取当前屏幕页面截图。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com/&#x27;</span>)</span><br><span class="line"><span class="comment"># 通过base64进行保存图片</span></span><br><span class="line">x = driver.get_screenshot_as_base64()</span><br><span class="line">image = base64.b64decode(x)</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&#x27;1.jpg&#x27;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">file.write(image)</span><br></pre></td></tr></table></figure>

<br />

<h5 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a><strong>方法二</strong></h5><p>save_screenshot(filename)是属于<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=Selenium&spm=1001.2101.3001.7020">Selenium</a>自带的截图函数，其中filename表示图片名称，道理一样，直接打开百度网页进行保存。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com/&#x27;</span>)</span><br><span class="line"><span class="comment"># 保存图片到本地</span></span><br><span class="line">driver.save_screenshot(<span class="string">&#x27;1.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<br />

<p><strong>方法三</strong></p>
<p>get_screenshot_as_file(filename)获取截图信息，其中filename表示图片名称，这里需要注意的是，图片信息只能保存为png格式的，其他的格式，代码会出现报错。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com/&#x27;</span>)</span><br><span class="line"><span class="comment"># 截图保存在本地</span></span><br><span class="line">driver.get_screenshot_as_file(<span class="string">&#x27;1.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<br />

<h5 id="方法四"><a href="#方法四" class="headerlink" title="方法四"></a>方法四</h5><p>get_screenshot_as_png() 通过二进制的方式进行保存图片。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&#x27;https://www.baidu.com/&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 截图保存在本地</span></span><br><span class="line"></span><br><span class="line">x = driver.get_screenshot_as_png()</span><br><span class="line">将二进制保存成图片形式</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&#x27;1.png&#x27;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">file.write(x)</span><br></pre></td></tr></table></figure>

<br />

<h5 id="截图长图"><a href="#截图长图" class="headerlink" title="截图长图"></a>截图长图</h5><p>上述截图方法中均是截取的当前页面的图片，那么如果我想要整个浏览器显示的内容全部截图下来怎么操作呢？其实方法一样的，我们只需要获取到浏览器的高度，然后就可以将截图全部都截取下来了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">coding:utf-<span class="number">8</span></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">opt = webdriver.ChromeOptions()</span><br><span class="line">opt.headless = <span class="literal">True</span>              <span class="comment"># 把Chrome设置成可视化无界面模式</span></span><br><span class="line">driver = webdriver.Chrome(options=opt)  <span class="comment"># 创建Chrome无界面对象</span></span><br><span class="line">driver.get(<span class="string">&#x27;http://www.51testing.com/html/news.html&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># js获取页面的宽高</span></span><br><span class="line"></span><br><span class="line">height = driver.execute_script(<span class="string">&quot;return document.documentElement.scrollHeight&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将浏览器的宽高设置成刚刚获取的宽高</span></span><br><span class="line"></span><br><span class="line">driver.set_window_size(<span class="number">1960</span>, height)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line">driver.save_screenshot(<span class="string">&#x27;22.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<br />

<p>需要注意的一点是，这里需要将浏览器设置成无页面模式，因为只有无页面形式才可以截全图，不然截的还是当前页面的图片，也就是浏览器的页面显示的。</p>
<p>执行完成代码后，发现我们已经将长图全部截取下来了。</p>
<br />

<br />

<h3 id="数据驱动"><a href="#数据驱动" class="headerlink" title="数据驱动"></a>数据驱动</h3><p>什么是数据驱动？</p>
<p>如果有一批测试用例，具有 <code>相同的测试步骤</code> ，只是 <code>测试参数数据不同</code> 。</p>
<br />

<p>自动化测试时，把测试数据从用例代码中 <code>分离</code> 开来，以后增加新的测试用例，只需要修改数据。</p>
<p>这就是数据驱动。</p>
<br />

<p>举个例子：</p>
<p>在做 登录功能 的测试，有一批测试用例，其执行的步骤几乎都是一样的，只是使用的测试参数不同。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> lib.webui <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UI_000x</span>:</span><br><span class="line"></span><br><span class="line">    ddt_cases = [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;登录 UI_0001&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;para&#x27;</span>: [<span class="literal">None</span>, <span class="string">&#x27;88888888&#x27;</span>,<span class="string">&#x27;请输入用户名&#x27;</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;登录 UI_0002&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;para&#x27;</span>: [<span class="string">&#x27;byhy&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;请输入密码&#x27;</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;登录 UI_0003&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;para&#x27;</span>: [<span class="string">&#x27;byh&#x27;</span>, <span class="string">&#x27;88888888&#x27;</span>,<span class="string">&#x27;登录失败 : 用户名或者密码错误&#x27;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">teststeps</span>(<span class="params">self</span>):</span><br><span class="line">        wd = GSTORE[<span class="string">&#x27;wd&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        wd.get(<span class="string">&#x27;http://127.0.0.1/mgr/sign.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        username, password, info = self.para</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            wd.find_element_by_id(<span class="string">&#x27;username&#x27;</span>).send_keys(username)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> password <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            wd.find_element_by_id(<span class="string">&#x27;password&#x27;</span>).send_keys(password)</span><br><span class="line"></span><br><span class="line">        wd.find_element_by_tag_name(<span class="string">&#x27;button&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">        sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        notify = wd.switch_to.alert.text</span><br><span class="line"></span><br><span class="line">        CHECK_POINT(<span class="string">&#x27;弹出提示&#x27;</span>, notify == info)</span><br><span class="line"></span><br><span class="line">        wd.switch_to.alert.accept()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">teardown</span>(<span class="params">self</span>):</span><br><span class="line">        wd = GSTORE[<span class="string">&#x27;wd&#x27;</span>]</span><br><span class="line">        wd.find_element_by_id(<span class="string">&#x27;username&#x27;</span>).clear()</span><br><span class="line">        wd.find_element_by_id(<span class="string">&#x27;password&#x27;</span>).clear()</span><br></pre></td></tr></table></figure>

<p>————————————————</p>
<br />

<br />

<ul>
<li>截屏 - 原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_60166861/article/details/133321434">https://blog.csdn.net/m0_60166861/article/details/133321434</a></li>
<li>看 “白月黑羽”的学习视频记录的笔记，感觉讲的十分不错。网址 - 【byhy.net】</li>
<li>官网学习Selenium，里面包含中文 【<a target="_blank" rel="noopener" href="https://www.selenium.dev/">Selenium</a>】</li>
</ul>



                    <div class="trm-divider footer-divider"></div>

                    <!-- footer -->
                    
<div class="trm-counter-up trm-scroll-animation">
  <div class="trm-counter-number">
    <span class="trm-counter">duoduo</span>
    <span class="trm-counter-symbol">+</span>
  </div>
  <div class="trm-divider trm-mb-20 trm-mt-20"></div>
  <div class="trm-label">Welcome</div>
</div>


                    <!-- footer end -->

                </div>
            </div>
        </div>
    </div>
</div>

            <!-- body end -->

            

            
<div class="trm-fixed-container">
    
    
    
    <div id="trm-back-top" class="trm-fixed-btn" data-title="回到顶部">
        <i class="iconfont fas fa-arrow-up"></i>
    </div>
</div>
        </div>
      </div>
      <!-- scroll container end -->
  </div>
  <!-- app wrapper end -->

  
  <!-- Plugin -->




    
    
<script src="https://npm.elemecdn.com/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>

    

    
        <script src="/js/plugins/typing.js?v=2.1.8"></script>
    

    

    <!-- 数学公式 -->
    

    <!-- 评论插件 -->
    
        

        
    



<!-- CDN -->


    

    

    




    <!-- Service Worker -->
    
    <!-- baidu push -->
    


<script id="async-script" src="/js/main.js?v=2.1.8"></script>

</body>

</html>